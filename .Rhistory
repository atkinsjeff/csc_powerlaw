#scale_fill_brewer(palette = "Dark2")+
#scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_smooth(data = subset(cst, pft == "DBF"),
method = "nls", formula = (y ~ a * x ^ b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE )+
stat_smooth(data = subset(cst, pft == "ENF"),
method = "nls", formula = (y ~ a * x^b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE )
geom_smooth(data = subset(cst, pft == "DBF"),
method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)
####
x11()
ggplot(cst, aes(x = can_max_ht, y = rugosity, fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "DBF"))+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "ENF"))
pft.rc <- aov(log10(rugosity) ~ log10(can_max_ht) + as.factor(pft), data = cst)
—DBF -2.29 +/- 0.19; ENF -3.70 +/- 0.59; MF -3.16 +/- 0.55 (p = <0.0001 for each combination
## DBF
# Rc ~ Hmax
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = DBF))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = DBF))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = enf))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = ENF))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = MF))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = MF))
confint(lm(log10(fhd) ~ log10(moch), data = cst))
summary(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
confint(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
summary(lm(log10(enl) ~ log10(can_max_ht), data = mf))
confint(lm(log10(enl) ~ log10(can_max_ht), data = mf))
#write.csv(cst, "power_law_csc_subset_20201110.csv")
slopes[1,] <- c("DBF", "Rugosity", 2.497, 0.13)
summary(lm(log10(enl) ~ log10(moch), data = DBF))
confint(lm(log10(enl) ~ log10(moch), data = DBF))
summary(lm(log10(rugosity) ~ log10(moch), data = enf))
confint(lm(log10(rugosity) ~ log10(moch), data = enf))
summary(lm(log10(rugosity) ~ log10(moch), data = mf))
confint(lm(log10(rugosity) ~ log10(moch), data = mf))
summary(lm(log10(fhd) ~ log10(moch), data = mf))
confint(lm(log10(fhd) ~ log10(moch), data = mf))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = mf))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = mf))
summary(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
confint(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
summary(lm(log10(enl) ~ log10(can_max_ht), data = mf))
confint(lm(log10(enl) ~ log10(can_max_ht), data = mf))
#write.csv(cst, "power_law_csc_subset_20201110.csv")
#write.csv(cst, "power_law_csc_subset_20201110.csv")
#### POWER LAW AND MOCH
####
#### scale_alpha_manual(values = c(0.5, 0.5, 0.5), guide = FALSE)+
p4 <- ggplot(cst, aes(x = log10(moch), y = log10(rugosity), fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.1, 0.1, 0.5), guide = FALSE)+
xlab("MOCH [m]")+
ylab(expression("R"[c]*{}*" [m]"))+
theme_light()+
# geom_smooth(data = subset(cst, pft == "DBF"),
#             method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)+
geom_smooth(data = subset(cst, pft == "MF"),
method = lm, se = FALSE, color = "#7570B3", size = 2, show.legend = FALSE)+
# geom_smooth(data = subset(cst, pft == "ENF"),
#             method = lm, se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE)+
theme(legend.position = "none")
p5 <- ggplot(cst, aes(x = log10(moch), y = log10(enl), fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.5, 0.1, 0.1), guide = FALSE)+
xlab("MOCH [m]")+
ylab("ENL")+
geom_smooth(data = subset(cst, pft == "DBF"),
method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)+
# geom_smooth(data = subset(cst, pft == "MF"),
#             method = lm, se = FALSE, color = "#7570B3", size = 2, show.legend = FALSE)+
# # geom_smooth(data = subset(cst, pft == "ENF"),
#             method = lm, se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE)+
theme_light()+
theme(legend.position = "none")
p6 <- ggplot(cst, aes(x = log10(moch), y = log10(fhd), fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.1, 0.1, 0.5), guide = FALSE)+
xlab("MOCH [m]")+
ylab("FHD")+
theme_light()+
# geom_smooth(data = subset(cst, pft == "ENF"),
#             method = lm, se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE)+
geom_smooth(data = subset(cst, pft == "MF"),
method = lm, se = FALSE, color = "#7570B3", size = 2, show.legend = FALSE)+
theme(legend.position = "none")
require(cowplot)
x11(width = 10, height = 7)
plot_grid(p1, p2, p3, p4, p5, p6, labels =  c("A", "B", "C", "D", "E", "F"), nrow = 2, label_size = 12)
###############################################
# Figure 3 - Max Ht vs MOCH
cst %>%
filter(pft == "ENF") %>%
data.frame() -> enf
summary(lm(moch ~ can_max_ht, data = enf))
cst %>%
filter(pft == "DBF") %>%
data.frame() -> DBF
summary(lm(moch ~ can_max_ht, data = DBF))
cst %>%
filter(pft == "MF") %>%
data.frame() -> mf
summary(lm(moch ~ can_max_ht, data = mf))
#### HEIGHT
x11(width = 5, height = 5)
h1 <- ggplot(cst, aes(x = can_max_ht, y = moch, color = pft))+
geom_point(size = 4, alpha = 0.25)+
scale_color_brewer(palette = "Dark2")+
xlab(expression("H"[Max]*{}*" [m]"))+
ylab("MOCH [m]")+
theme_light()+
theme(panel.grid = element_blank(),
axis.text = element_text(size = 12))+
xlim(5, 45)+
ylim(5, 30)+
geom_abline(slope = 1, intercept = 0, size = 1, color = "black")+
stat_smooth(method = "lm", se = FALSE, size = 2)+
theme(legend.justification = c(0.98, 0), legend.position = c(0.98, 0.02),
legend.title = element_blank(), legend.background = element_rect(linetype = 1,
size = 0.5,
color = "black"))
cst %>%
select(siteID, moch, can_max_ht) %>%
dplyr::group_by(siteID) %>%
dplyr::summarize(moch = mean(moch),
max_ht = mean(can_max_ht), max.sd = sd(can_max_ht)) %>%
data.frame() -> bob
cst %>%
select(siteID, moch, can_max_ht) %>%
dplyr::group_by(siteID) %>%
dplyr::summarize(moch.sd = sd(moch)) %>%
data.frame() -> bill
bob <- merge(bob, bill)
require(ggrepel)
h2 <- ggplot(bob, aes(x = max_ht, y = moch, label = siteID))+
geom_errorbar(aes(ymin = moch - moch.sd, ymax = moch + moch.sd), width = 0.1, color = "grey")+
geom_errorbarh(aes(xmin = max_ht - max.sd, xmax = max_ht + max.sd), width = 0.1, color = "grey")+
geom_point(size = 8, shape = 21, fill = "grey")+
#scale_fill_brewer(palette = "Dark2")+
xlab(expression("H"[Max]*{}*" [m]"))+
ylab("MOCH [m]")+
theme_light()+
# xlim(5, 45)+
# ylim(5, 30)+
theme(legend.position = "none",
panel.grid = element_blank(),
axis.text = element_text(size = 12))+
geom_abline(slope = 1, intercept = 0, size = 1, color = "black")+
geom_label_repel(fill = "white", box.padding = 0.6)
x11(width = 12, height = 6)
plot_grid(h1, h2, labels =  c("A", "B"), label_size = 12)
#####
dbf.model  <-
x11()
ggplot(cst, aes(x = can_max_ht, y = rugosity, fill = pft, alpha = pft))+
#geom_point(size = 2, shape = 21)+
#scale_fill_brewer(palette = "Dark2")+
#scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_smooth(data = subset(cst, pft == "DBF"),
method = "nls", formula = (y ~ a * x ^ b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE )+
stat_smooth(data = subset(cst, pft == "ENF"),
method = "nls", formula = (y ~ a * x^b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE )
geom_smooth(data = subset(cst, pft == "DBF"),
method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)
####
x11()
ggplot(cst, aes(x = can_max_ht, y = rugosity, fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "DBF"))+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "ENF"))
pft.rc <- aov(log10(rugosity) ~ log10(can_max_ht) + as.factor(pft), data = cst)
TukeyHSD(pft.rc)
#######
# linear regression
cst %>%
group_by(pft) %>%
nest() %>%
mutate(model = map(data, ~lm(moch ~ can_max_ht, data =.))) -> mods
mods %>%
rowwise(mods) %>%
tidy(model)
summary(lm(rugosity ~ can_max_ht, data = cst))
summary(lm(fhd ~ can_max_ht, data = cst))
# trying with data tabl
max_ht = mean(can_max_ht), max.sd = sd(can_max_ht)) %>%
data.frame() -> bob
—DBF -2.29 +/- 0.19; ENF -3.70 +/- 0.59; MF -3.16 +/- 0.55 (p = <0.0001 for each combination
## DBF
# Rc ~ Hmax
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = DBF))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = DBF))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = enf))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = ENF))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = MF))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = MF))
confint(lm(log10(fhd) ~ log10(moch), data = cst))
summary(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
confint(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
summary(lm(log10(enl) ~ log10(can_max_ht), data = mf))
confint(lm(log10(enl) ~ log10(can_max_ht), data = mf))
#write.csv(cst, "power_law_csc_subset_20201110.csv")
slopes[1,] <- c("DBF", "Rugosity", 2.497, 0.13)
summary(lm(log10(enl) ~ log10(moch), data = DBF))
confint(lm(log10(enl) ~ log10(moch), data = DBF))
summary(lm(log10(rugosity) ~ log10(moch), data = enf))
confint(lm(log10(rugosity) ~ log10(moch), data = enf))
summary(lm(log10(rugosity) ~ log10(moch), data = mf))
confint(lm(log10(rugosity) ~ log10(moch), data = mf))
summary(lm(log10(fhd) ~ log10(moch), data = mf))
confint(lm(log10(fhd) ~ log10(moch), data = mf))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = mf))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = mf))
summary(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
confint(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
summary(lm(log10(enl) ~ log10(can_max_ht), data = mf))
confint(lm(log10(enl) ~ log10(can_max_ht), data = mf))
#write.csv(cst, "power_law_csc_subset_20201110.csv")
#write.csv(cst, "power_law_csc_subset_20201110.csv")
#### POWER LAW AND MOCH
####
#### scale_alpha_manual(values = c(0.5, 0.5, 0.5), guide = FALSE)+
p4 <- ggplot(cst, aes(x = log10(moch), y = log10(rugosity), fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.1, 0.1, 0.5), guide = FALSE)+
xlab("MOCH [m]")+
ylab(expression("R"[c]*{}*" [m]"))+
theme_light()+
# geom_smooth(data = subset(cst, pft == "DBF"),
#             method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)+
geom_smooth(data = subset(cst, pft == "MF"),
method = lm, se = FALSE, color = "#7570B3", size = 2, show.legend = FALSE)+
# geom_smooth(data = subset(cst, pft == "ENF"),
#             method = lm, se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE)+
theme(legend.position = "none")
p5 <- ggplot(cst, aes(x = log10(moch), y = log10(enl), fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.5, 0.1, 0.1), guide = FALSE)+
xlab("MOCH [m]")+
ylab("ENL")+
geom_smooth(data = subset(cst, pft == "DBF"),
method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)+
# geom_smooth(data = subset(cst, pft == "MF"),
#             method = lm, se = FALSE, color = "#7570B3", size = 2, show.legend = FALSE)+
# # geom_smooth(data = subset(cst, pft == "ENF"),
#             method = lm, se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE)+
theme_light()+
theme(legend.position = "none")
p6 <- ggplot(cst, aes(x = log10(moch), y = log10(fhd), fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.1, 0.1, 0.5), guide = FALSE)+
xlab("MOCH [m]")+
ylab("FHD")+
theme_light()+
# geom_smooth(data = subset(cst, pft == "ENF"),
#             method = lm, se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE)+
geom_smooth(data = subset(cst, pft == "MF"),
method = lm, se = FALSE, color = "#7570B3", size = 2, show.legend = FALSE)+
theme(legend.position = "none")
require(cowplot)
x11(width = 10, height = 7)
plot_grid(p1, p2, p3, p4, p5, p6, labels =  c("A", "B", "C", "D", "E", "F"), nrow = 2, label_size = 12)
###############################################
# Figure 3 - Max Ht vs MOCH
cst %>%
filter(pft == "ENF") %>%
data.frame() -> enf
summary(lm(moch ~ can_max_ht, data = enf))
cst %>%
filter(pft == "DBF") %>%
data.frame() -> DBF
summary(lm(moch ~ can_max_ht, data = DBF))
cst %>%
filter(pft == "MF") %>%
data.frame() -> mf
summary(lm(moch ~ can_max_ht, data = mf))
#### HEIGHT
x11(width = 5, height = 5)
h1 <- ggplot(cst, aes(x = can_max_ht, y = moch, color = pft))+
geom_point(size = 4, alpha = 0.25)+
scale_color_brewer(palette = "Dark2")+
xlab(expression("H"[Max]*{}*" [m]"))+
ylab("MOCH [m]")+
theme_light()+
theme(panel.grid = element_blank(),
axis.text = element_text(size = 12))+
xlim(5, 45)+
ylim(5, 30)+
geom_abline(slope = 1, intercept = 0, size = 1, color = "black")+
stat_smooth(method = "lm", se = FALSE, size = 2)+
theme(legend.justification = c(0.98, 0), legend.position = c(0.98, 0.02),
legend.title = element_blank(), legend.background = element_rect(linetype = 1,
size = 0.5,
color = "black"))
cst %>%
select(siteID, moch, can_max_ht) %>%
dplyr::group_by(siteID) %>%
dplyr::summarize(moch = mean(moch),
max_ht = mean(can_max_ht), max.sd = sd(can_max_ht)) %>%
data.frame() -> bob
cst %>%
select(siteID, moch, can_max_ht) %>%
dplyr::group_by(siteID) %>%
dplyr::summarize(moch.sd = sd(moch)) %>%
data.frame() -> bill
bob <- merge(bob, bill)
require(ggrepel)
h2 <- ggplot(bob, aes(x = max_ht, y = moch, label = siteID))+
geom_errorbar(aes(ymin = moch - moch.sd, ymax = moch + moch.sd), width = 0.1, color = "grey")+
geom_errorbarh(aes(xmin = max_ht - max.sd, xmax = max_ht + max.sd), width = 0.1, color = "grey")+
geom_point(size = 8, shape = 21, fill = "grey")+
#scale_fill_brewer(palette = "Dark2")+
xlab(expression("H"[Max]*{}*" [m]"))+
ylab("MOCH [m]")+
theme_light()+
# xlim(5, 45)+
# ylim(5, 30)+
theme(legend.position = "none",
panel.grid = element_blank(),
axis.text = element_text(size = 12))+
geom_abline(slope = 1, intercept = 0, size = 1, color = "black")+
geom_label_repel(fill = "white", box.padding = 0.6)
x11(width = 12, height = 6)
plot_grid(h1, h2, labels =  c("A", "B"), label_size = 12)
#####
dbf.model  <-
x11()
ggplot(cst, aes(x = can_max_ht, y = rugosity, fill = pft, alpha = pft))+
#geom_point(size = 2, shape = 21)+
#scale_fill_brewer(palette = "Dark2")+
#scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_smooth(data = subset(cst, pft == "DBF"),
method = "nls", formula = (y ~ a * x ^ b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE )+
stat_smooth(data = subset(cst, pft == "ENF"),
method = "nls", formula = (y ~ a * x^b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE )
geom_smooth(data = subset(cst, pft == "DBF"),
method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)
####
x11()
ggplot(cst, aes(x = can_max_ht, y = rugosity, fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "DBF"))+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "ENF"))
##### difference in slopes
pft.rc <- aov(log10(rugosity) ~ log10(can_max_ht) + as.factor(pft), data = cst))
pft.rc <- aov(log10(rugosity) ~ log10(can_max_ht) + as.factor(pft), data = cst))
# Rc ~ Hmax
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = DBF))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = DBF))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = enf))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = ENF))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = MF))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = MF))
confint(lm(log10(fhd) ~ log10(moch), data = cst))
summary(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
confint(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
summary(lm(log10(enl) ~ log10(can_max_ht), data = mf))
confint(lm(log10(enl) ~ log10(can_max_ht), data = mf))
#write.csv(cst, "power_law_csc_subset_20201110.csv")
slopes[1,] <- c("DBF", "Rugosity", 2.497, 0.13)
summary(lm(log10(enl) ~ log10(moch), data = DBF))
confint(lm(log10(enl) ~ log10(moch), data = DBF))
summary(lm(log10(rugosity) ~ log10(moch), data = enf))
confint(lm(log10(rugosity) ~ log10(moch), data = enf))
summary(lm(log10(rugosity) ~ log10(moch), data = mf))
confint(lm(log10(rugosity) ~ log10(moch), data = mf))
summary(lm(log10(fhd) ~ log10(moch), data = mf))
confint(lm(log10(fhd) ~ log10(moch), data = mf))
summary(lm(log10(rugosity) ~ log10(can_max_ht), data = mf))
confint(lm(log10(rugosity) ~ log10(can_max_ht), data = mf))
summary(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
confint(lm(log10(fhd) ~ log10(can_max_ht), data = mf))
summary(lm(log10(enl) ~ log10(can_max_ht), data = mf))
confint(lm(log10(enl) ~ log10(can_max_ht), data = mf))
cst %>%
filter(pft == "ENF") %>%
data.frame() -> enf
summary(lm(moch ~ can_max_ht, data = enf))
cst %>%
filter(pft == "DBF") %>%
data.frame() -> DBF
summary(lm(moch ~ can_max_ht, data = DBF))
cst %>%
filter(pft == "MF") %>%
data.frame() -> mf
summary(lm(moch ~ can_max_ht, data = mf))
#### HEIGHT
x11(width = 5, height = 5)
h1 <- ggplot(cst, aes(x = can_max_ht, y = moch, color = pft))+
geom_point(size = 4, alpha = 0.25)+
scale_color_brewer(palette = "Dark2")+
xlab(expression("H"[Max]*{}*" [m]"))+
ylab("MOCH [m]")+
theme_light()+
theme(panel.grid = element_blank(),
axis.text = element_text(size = 12))+
xlim(5, 45)+
ylim(5, 30)+
geom_abline(slope = 1, intercept = 0, size = 1, color = "black")+
stat_smooth(method = "lm", se = FALSE, size = 2)+
theme(legend.justification = c(0.98, 0), legend.position = c(0.98, 0.02),
legend.title = element_blank(), legend.background = element_rect(linetype = 1,
size = 0.5,
color = "black"))
cst %>%
select(siteID, moch, can_max_ht) %>%
dplyr::group_by(siteID) %>%
dplyr::summarize(moch = mean(moch),
max_ht = mean(can_max_ht), max.sd = sd(can_max_ht)) %>%
data.frame() -> bob
cst %>%
select(siteID, moch, can_max_ht) %>%
dplyr::group_by(siteID) %>%
dplyr::summarize(moch.sd = sd(moch)) %>%
data.frame() -> bill
bob <- merge(bob, bill)
require(ggrepel)
h2 <- ggplot(bob, aes(x = max_ht, y = moch, label = siteID))+
geom_errorbar(aes(ymin = moch - moch.sd, ymax = moch + moch.sd), width = 0.1, color = "grey")+
geom_errorbarh(aes(xmin = max_ht - max.sd, xmax = max_ht + max.sd), width = 0.1, color = "grey")+
geom_point(size = 8, shape = 21, fill = "grey")+
#scale_fill_brewer(palette = "Dark2")+
xlab(expression("H"[Max]*{}*" [m]"))+
ylab("MOCH [m]")+
theme_light()+
# xlim(5, 45)+
# ylim(5, 30)+
theme(legend.position = "none",
panel.grid = element_blank(),
axis.text = element_text(size = 12))+
geom_abline(slope = 1, intercept = 0, size = 1, color = "black")+
geom_label_repel(fill = "white", box.padding = 0.6)
x11(width = 12, height = 6)
plot_grid(h1, h2, labels =  c("A", "B"), label_size = 12)
#####
dbf.model  <-
x11()
ggplot(cst, aes(x = can_max_ht, y = rugosity, fill = pft, alpha = pft))+
#geom_point(size = 2, shape = 21)+
#scale_fill_brewer(palette = "Dark2")+
#scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_smooth(data = subset(cst, pft == "DBF"),
method = "nls", formula = (y ~ a * x ^ b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE )+
stat_smooth(data = subset(cst, pft == "ENF"),
method = "nls", formula = (y ~ a * x^b),
method.args = list(start = c(a = 1, b = 1)),
se = FALSE, color = "#D95F02", size = 2, show.legend = FALSE )
geom_smooth(data = subset(cst, pft == "DBF"),
method = lm, se = FALSE, color = "#1B9E77", size = 2, show.legend = FALSE)
####
x11()
ggplot(cst, aes(x = can_max_ht, y = rugosity, fill = pft, alpha = pft))+
geom_point(size = 2, shape = 21)+
scale_fill_brewer(palette = "Dark2")+
scale_alpha_manual(values = c(0.5, 0.5, 0.1), guide = FALSE)+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "DBF"))+
geom_encircle(aes(x = can_max_ht, y = rugosity),
data = subset(cst, pft == "ENF"))
##### difference in slopes
pft.rc <- aov(log10(rugosity) ~ log10(can_max_ht) + as.factor(pft), data = cst))
TukeyHSD(pft.rc)
pft.rc
##### difference in slopes
pft.rc <- aov(log10(rugosity) ~ log10(can_max_ht) + as.factor(pft), data = cst)
TukeyHSD(pft.rc)
pft.rc
str(Cst)
str(cst)
str(df3)
fit.pft.neon
Anova(pft.rc)
TukeyHSD(pft.rc)
Anova(pft.rc, type="III")
Anova(fit.pft.neon, type="III")
mean(13,9,13,12,14,12,12,10,13,10,10)
sd(13,9,13,12,14,12,12,10,13,10,10)
mean(c(13,9,13,12,14,12,12,10,13,10,10))
sd(13,9,13,12,14,12,12,10,13,10,10)
sd(c(13,9,13,12,14,12,12,10,13,10,10))
